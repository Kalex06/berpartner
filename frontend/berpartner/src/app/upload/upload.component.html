<main class="upload-page">
    <button class="back-btn" routerLink="/home"  aria-label="Vissza a főoldalra">
        <mat-icon>home</mat-icon>
    </button>
    <div class="upload-card">
        <h1 class="page-title">Új hirdetés feladása</h1>

        <form class="upload-form" (ngSubmit)="SendItem()">
            <section class="images-section">
                <h2 class="section-title">Képek</h2>

                <!-- Kép Feltöltés -->
                <div class="image-grid">
                    <div *ngFor="let img of imagePreviews; let i = index" class="image-upload-box"
                        (click)="fileInput.click()">

                        <input type="file" #fileInput accept="image/*" hidden (change)="onFileSelected($event, i)">

                        <ng-container *ngIf="imagePreviews[i]; else placeholder">
                            <img [src]="imagePreviews[i]" class="preview-img">
                            <div class="remove-overlay" (click)="removeImage(i, $event)">
                                <mat-icon>delete</mat-icon>
                            </div>
                        </ng-container>

                        <ng-template #placeholder>
                            <div class="upload-placeholder">
                                <mat-icon>add_photo_alternate</mat-icon>
                                <span>Kép {{i + 1}}</span>
                            </div>
                        </ng-template>
                    </div>
                </div>
                <p class="image-hint">Legalább 1, legfeljebb 4 képet tölthetsz fel (max. 5 MB / kép)</p>
            </section>

            <section class="form-section" [formGroup]="uploadForm" >
                <h2>Hirdetés adatai</h2>
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Hirdetés neve</mat-label>
                    <input matInput placeholder="Pl. Bosch GSB 600, Ütvefúrógép, 600W" formControlName="title" required>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Kategória</mat-label>
                    <mat-select formControlName="category" required>
                        <mat-optgroup *ngFor="let maincategory of maincategories" [label]="maincategory.fo_kategoria">
                            <mat-option *ngFor="let category of maincategory.kategoriak" [value]="category.id">
                                {{category.kategoria}}    
                            </mat-option>
                        </mat-optgroup>
                    </mat-select>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Állapot</mat-label>
                    <mat-select formControlName="condition" required>
                        @for (condition of conditions; track condition) {
                        <mat-option [value]="condition.value">{{condition.viewValue}}</mat-option>
                        }
                    </mat-select>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Napi díj (Ft)</mat-label>
                    <input matInput type="number" class="no-spinners" placeholder="Pl. 2500"
                        (wheel)="$event.preventDefault()" formControlName="dailyFee" required>
                    <span matTextSuffix>Ft / nap</span>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width" floatLabel="always">
                    <mat-label>Leírás</mat-label>
                    <textarea matInput rows="5"
                        placeholder="Leírás az eszközről, állapotáról és egyéb információkról..."
                        formControlName="description" required>
                    </textarea>
                </mat-form-field>
            </section>

            <footer class="action-bar">
                <button mat-flat-button class="submit-btn" type="submit" [disabled]="uploadForm.invalid">
                    Hirdetés feladása
                </button>
            </footer>
        </form>
    </div>
</main>
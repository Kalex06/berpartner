<div class="registration-container">
  <a routerLink="/" class="logo">
    <img src="assets/pictures/logo_2.png" alt="BérPartner Logo">
  </a>

  <h2>Regisztráció</h2>

  <div class="stepper-card">
    <mat-horizontal-stepper linear #stepper>

      <mat-step [stepControl]="nameFormGroup">
        <ng-template matStepLabel>Adja meg a nevét</ng-template>

        <form [formGroup]="nameFormGroup" class="step-form">
          <div class="form-grid">
            <mat-form-field appearance="outline">
              <mat-label>Vezetéknév</mat-label>
              <input matInput placeholder="Kiss" formControlName="lastName" required>
              <mat-error *ngIf="nameFormGroup.get('lastName')?.hasError('required')">
                Kötelező kitölteni
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Keresztnév</mat-label>
              <input matInput placeholder="Pista" formControlName="firstName" required>
              <mat-error *ngIf="nameFormGroup.get('firstName')?.hasError('required')">
                Kötelező kitölteni
              </mat-error>
            </mat-form-field>
          </div>

          <div class="step-actions">
            <div class="next-button">
              <button mat-flat-button color="accent" matStepperNext>Tovább</button>
            </div>
          </div>
        </form>
      </mat-step>


      <mat-step [stepControl]="contactFormGroup">
        <ng-template matStepLabel>Elérhetőségek</ng-template>
        <form [formGroup]="contactFormGroup" class="step-form">
          <div class="form-grid">
            <mat-form-field appearance="outline">
              <mat-label>E-mail cím</mat-label>
              <input matInput type="email" placeholder="kisspista@gmail.com" formControlName="email" required>
              <mat-error *ngIf="contactFormGroup.get('email')?.invalid">
                Érvénytelen e-mail cím
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Telefonszám</mat-label>
              <input matInput placeholder="+36 20 999 1234" formControlName="phone" required>
              <mat-error *ngIf="contactFormGroup.get('phone')?.hasError('required')">
                Kötelező mező
              </mat-error>
              <mat-error *ngIf="contactFormGroup.get('phone')?.hasError('pattern')">
                Érvénytelen telefonszám formátum.
              </mat-error>
            </mat-form-field>
          </div>

          <div class="step-actions">
            <div class="back-button">
              <button mat-stroked-button matStepperPrevious>Vissza</button>
            </div>
            <div class="next-button">
              <button mat-flat-button color="accent" matStepperNext>Tovább</button>
            </div>
          </div>
        </form>
      </mat-step>


      <mat-step [stepControl]="passwordFormGroup">
        <ng-template matStepLabel>Adja meg a jelszavát</ng-template>

        <form [formGroup]="passwordFormGroup" class="step-form">
          <div class="form-grid">

            <mat-form-field appearance="outline">
              <mat-label>Jelszó</mat-label>
              <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" required>
              <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button" tabindex="-1">
                <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
              <mat-error *ngIf="passwordFormGroup.get('password')?.hasError('required') && passwordStepSubmitted">
                Kötelező kitölteni
              </mat-error>
              <mat-error *ngIf="passwordFormGroup.get('password')?.hasError('mustMatch')">
                A jelszavak nem egyeznek
              </mat-error>
            </mat-form-field>


            <mat-form-field appearance="outline">
              <mat-label>Jelszó újra</mat-label>
              <input matInput [type]="hideConfirm ? 'password' : 'text'" formControlName="confirmPassword" required>
              <button mat-icon-button matSuffix (click)="hideConfirm = !hideConfirm" type="button" tabindex="-1">
                <mat-icon>{{hideConfirm ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
              <mat-error
                *ngIf="passwordFormGroup.get('confirmPassword')?.hasError('required') && passwordStepSubmitted">
                Kötelező kitölteni
              </mat-error>
              <mat-error *ngIf="passwordFormGroup.errors?.['mustMatch'] && passwordFormGroup.touched">
                A jelszavak nem egyeznek
              </mat-error>
            </mat-form-field>
          </div>

          <div class="step-actions">
            <div class="back-button">
              <button mat-stroked-button matStepperPrevious>Vissza</button>
            </div>
            <div class="next-button">
              <button mat-flat-button color="accent" (click)="goPasswordNext(stepper)">Tovább</button>
            </div>
          </div>
        </form>
      </mat-step>

      <mat-step [stepControl]="addressFormGroup">
        <ng-template matStepLabel>Postázási cím</ng-template>

        <form [formGroup]="addressFormGroup" class="step-form">
          <div class="form-grid">
            <mat-form-field appearance="outline">
              <mat-label>Város</mat-label>
              <input matInput placeholder="Pl. Kalocsa" formControlName="varos" required>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Irányítószám</mat-label>
              <input matInput placeholder="Pl. 6300" formControlName="iranyitoszam" required>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Utca</mat-label>
              <input matInput placeholder="Pl. Miskei út" formControlName="utca" required>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Házszám</mat-label>
              <input matInput placeholder="Pl. 99" formControlName="hazszam" required>
            </mat-form-field>
          </div>

          <div class="step-actions">
            <div class="back-button">
              <button mat-stroked-button matStepperPrevious>Vissza</button>
            </div>
            <div class="next-button">
              <button mat-flat-button color="accent" matStepperNext (click)="submit()"
                [disabled]="addressFormGroup.invalid">Befejezés</button>
            </div>
          </div>
        </form>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>Befejezés</ng-template>
        <div class="completion-step">
          <mat-icon class="success-icon">check_circle</mat-icon>
          <h3>Köszönjük a regisztrációt!</h3>
          <p>A profilja elkészült. Már nyugodtan használhatja az oldalt!</p>
          <p>Lépjen tovább a bejelentkezéshez.</p>

          <div class="step-actions">
            <div class="next-button">
              <a routerLink="/home"><button mat-flat-button color="accent">Tovább a főoldalra</button></a>
            </div>
          </div>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </div>
</div>